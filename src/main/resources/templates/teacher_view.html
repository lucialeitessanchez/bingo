<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <title>Teacher's Dashbord</title>
    <link rel="icon" type="image/png" sizes="32x32" th:href="@{/images/bingoIcon.png}">
    <link rel="stylesheet" th:href="@{/css/style.css}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    
    </head>
<body>
    
    <div class="container teacher-view">
        
        <div th:if="${error}" class="message error" th:text="${error}"></div>
        <div th:if="${message}" class="message success" th:text="${message}"></div>

    <div th:if="${newCardText}" 
         class="card" 
         th:style="'background-color:' + ${newCardColor}"> <div class="card-body">
            <img th:src="@{'/images/juguetes/' + ${newCardObject} + '.png'}" 
                 th:alt="${newCardText}" 
                 class="card-toy-image" />
            
        </div>
    </div>

    </div>

    <div th:if="${error}" class="alert alert-danger" th:text="${error}"></div>
</div>

        <div class="status-bar">
            <p>Player connected: <span th:text="${playerCount}"></span> / <span th:text="${maxPlayers}"></span></p>
            <p th:if="${gameActive}" class="active">STATE: STARTED GAME</p>
            <p th:if="${!gameActive and winnerId == null}" class="waiting">State: WAITING ...</p>
            <p th:if="${winnerId != null}" class="finished">WIN: <span th:text="${winnerId}"></span> - ¡GAME FINISH!</p>
        </div>

        <div class="controls">
            <form th:action="@{/teacher/start}" method="post" th:if="${!gameActive and playerCount > 0}">
                <button type="submit" class="btn btn-info" >Start game</button>
            </form>
            <div th:if="${!gameActive and playerCount == 0}" class="message error">
                <p>Any players connected to start de game</p>
            </div>

            <div class="btn-group" role="group" aria-label="Basic example">
            <form th:action="@{/teacher/next-phrase}" method="post" th:if="${gameActive and winnerId == null}">
                <button type="submit"  class="btn btn-primary">Generate new Phrase</button>
            </form>
            
            <form th:action="@{/teacher/reset}" method="post">
                <button type="submit" class="btn btn-outline-warning" onclick="return confirm('¿Seguro que quieres resetear el juego y eliminar jugadores?')">Reset players</button>
            </form>
            </div>
        </div>
        
        <hr/>
        
        <div th:if="${!gameActive and winnerId == null}" class="game-info-panel">
            <h2>Scan QR for joining the game</h2>
        
            
            <img th:src="@{/teacher/qr-code.png}" alt="Código QR para unirse al juego" class="qr-code-image"> 
        </div>

        <div th:if="${gameActive and winnerId == null}" class="game-info-panel active-game-image">
        
        </div>

       <div class="history">
    <h2>Shown toys</h2>
    <ul th:if="${!historyPhrases.isEmpty()}" class="phrase-list">
        <li th:each="entry : ${historyPhrases}">
            <div class="toy-colored"
                 th:style="'--toy-color: ' + ${entry.color} + 
                           '; --toy-mask-url: url(\'/images/juguetes/' + ${entry.toy} + '.png\');'">
            </div>
            <span th:text="${entry.phrase}"></span>
        </li>
    </ul>
    <p th:if="${historyPhrases.isEmpty()}">Any toy show</p>
</div>
    </div>
    
</body>
</html>